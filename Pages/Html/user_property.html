<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Properties ‚Äî PadPick</title>
    <link rel="icon" href="/Asset/Screenshot_2026-02-10_215817-removebg-preview.png" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../Css/subareas.css">
    <style>
        /* ‚îÄ‚îÄ EXTRA STYLES for My Properties page only ‚îÄ‚îÄ */

        /* action buttons row inside card */
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        .btn.edit-btn {
            background: var(--dark);
            color: var(--cream);
            border: none;
        }

        .btn.edit-btn:hover {
            background: var(--accent);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(200,169,110,0.28);
        }

        .btn.delete-btn {
            background: transparent;
            color: #D94F4F;
            border: 1.5px solid rgba(217,79,79,0.3);
            cursor: pointer;
            font-family: 'DM Sans', sans-serif;
            font-size: 13px;
            font-weight: 500;
            border-radius: 10px;
            padding: 11px 22px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transition: background 0.2s, transform 0.18s, box-shadow 0.18s, color 0.2s;
            width: 100%;
        }

        .btn.delete-btn:hover {
            background: #D94F4F;
            color: white;
            border-color: #D94F4F;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(217,79,79,0.25);
        }

        /* empty state */
        .empty-state {
            text-align: center;
            padding: 80px 20px;
        }

        .empty-icon {
            font-size: 52px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-family: 'Playfair Display', serif;
            font-size: 22px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 10px;
            letter-spacing: -0.3px;
        }

        .empty-state p {
            font-size: 14px;
            color: var(--muted);
            font-weight: 300;
            margin-bottom: 28px;
        }

        .empty-cta {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            background: var(--dark);
            color: var(--cream);
            padding: 13px 28px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.2s, transform 0.18s;
        }

        .empty-cta:hover {
            background: var(--accent);
            transform: translateY(-2px);
        }
    </style>
</head>
<body>

<!-- HEADER -->
<header>
    <a class="logo" href="./home.html">Pad<span>Pick</span></a>
    <nav class="navbar">
        <ul>
            <li><a href="./home.html">Home</a></li>
            <li><a href="./Areas.html">Areas</a></li>
            <li><a href="./profile.html" class="active">Profile</a></li>
        </ul>
    </nav>
</header>

<!-- HERO -->
<div class="page-hero">
    <div class="hero-tag">‚ú¶ Your Listings</div>
    <h1>My<br><em>Properties.</em></h1>
    <p>Manage, edit, or remove the properties you have listed on PadPick.</p>
</div>

<!-- BREADCRUMB -->
<div class="breadcrumb">
    <a href="./profile.html">‚Üê Profile</a>
    <span>/</span>
    <span>My Properties</span>
</div>

<!-- MAIN -->
<div class="container">

    <div class="section-meta">
        <div id="areaTitle">My Properties</div>
        <div class="listing-count" id="listingCount"></div>
    </div>

    <!-- Skeleton loader -->
    <div class="skeleton-grid" id="skeletonLoader">
        <div class="skeleton-card">
            <div class="skeleton-img"></div>
            <div class="skeleton-body">
                <div class="skeleton-line"></div>
                <div class="skeleton-line short"></div>
                <div class="skeleton-btn"></div>
            </div>
        </div>
        <div class="skeleton-card">
            <div class="skeleton-img"></div>
            <div class="skeleton-body">
                <div class="skeleton-line"></div>
                <div class="skeleton-line short"></div>
                <div class="skeleton-btn"></div>
            </div>
        </div>
        <div class="skeleton-card">
            <div class="skeleton-img"></div>
            <div class="skeleton-body">
                <div class="skeleton-line"></div>
                <div class="skeleton-line short"></div>
                <div class="skeleton-btn"></div>
            </div>
        </div>
    </div>

    <div id="pgList" class="pg-list"></div>
    <div id="msg" class="message"></div>

    <div class="back-wrap">
        <a href="./profile.html" class="back-btn">‚Üê Back to Profile</a>
    </div>

</div>

<footer>
    &copy; 2025 <span>PadPick</span>. All rights reserved.
</footer>

<!-- ================= JS ‚Äî UNCHANGED ================= -->
<script>
const userId = localStorage.getItem("user_id");
const list = document.getElementById("pgList");
const msg = document.getElementById("msg");

if (!userId) {
    document.getElementById("skeletonLoader").style.display = "none";
    msg.innerText = "Please login again";
} else {
    loadMyProperties();
}

function loadMyProperties() {
    list.innerHTML = "";
    msg.innerText = "";

    fetch(`https://padpick-backend.vercel.app/homes/by-user/${userId}`)
        .then(res => res.json())
        .then(data => {

            document.getElementById("skeletonLoader").style.display = "none";

            if (!Array.isArray(data) || data.length === 0) {
                list.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üè†</div>
                        <h3>No properties yet</h3>
                        <p>You haven't posted any property listings yet.<br>Start by adding your first one.</p>
                        <a class="empty-cta" href="./property.html">Post a Property ‚Üí</a>
                    </div>
                `;
                document.getElementById("listingCount").innerText = "0 listings";
                return;
            }

            document.getElementById("listingCount").innerText = data.length + " listing" + (data.length !== 1 ? "s" : "");

            data.forEach((home, i) => {
                const card = document.createElement("div");
                card.className = "pg-card";
                card.style.animationDelay = (i * 0.07) + "s";
                card.innerHTML = `
                    <div class="img-wrap">
                        <img src="${home.img1}" alt="${home.name}">
                        <div class="price-badge">‚Çπ ${home.price} / month</div>
                    </div>
                    <div class="content">
                        <h3>${home.name}</h3>
                        <div class="action-buttons">
                            <a href="./Edit_property.html?home_id=${home.id}" class="btn edit-btn">
                                ‚úèÔ∏è Edit
                            </a>
                            <button class="btn delete-btn" onclick="deleteHome(${home.id})">
                                üóë Delete
                            </button>
                        </div>
                    </div>
                `;
                list.appendChild(card);
            });
        })
        .catch(err => {
            console.error(err);
            document.getElementById("skeletonLoader").style.display = "none";
            msg.innerText = "Backend not reachable";
        });
}

function deleteHome(homeId) {
    if (!confirm("Are you sure you want to delete this property?")) return;

    fetch(`https://padpick-backend.vercel.app/homes/${homeId}`, {
        method: "DELETE"
    })
    .then(res => res.json())
    .then(() => {
        alert("Property deleted successfully ‚úÖ");
        loadMyProperties();
    })
    .catch(err => {
        console.error(err);
        alert("Delete failed ‚ùå");
    });
}
</script>

</body>
</html>